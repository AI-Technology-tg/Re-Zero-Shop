<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Collection & Analysis Platform</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #4a5568;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            color: #718096;
            font-size: 1.1rem;
        }

        .data-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .data-section h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.8rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .data-card {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #667eea;
        }

        .data-card h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .data-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-item:last-child {
            border-bottom: none;
        }

        .data-label {
            font-weight: 600;
            color: #4a5568;
            flex: 1;
        }

        .data-value {
            color: #2d3748;
            background: #edf2f7;
            padding: 4px 8px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            max-width: 200px;
            word-break: break-all;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-item {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e2e8f0;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #718096;
            font-size: 0.9rem;
        }

        .progress-section {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: #e2e8f0;
            border-radius: 12px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 12px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .export-section {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn.json {
            background: #ed8936;
        }

        .btn.csv {
            background: #4299e1;
        }

        .btn.txt {
            background: #48bb78;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #48bb78;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .timeline {
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .timeline-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .timeline-time {
            color: #718096;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .timeline-title {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .timeline-description {
            color: #4a5568;
            font-size: 0.9rem;
        }

        .no-data {
            text-align: center;
            color: #718096;
            font-style: italic;
            padding: 20px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .data-grid {
                grid-template-columns: 1fr;
            }
            
            .export-buttons {
                flex-direction: column;
            }
            
            .data-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .data-value {
                max-width: 100%;
                margin-top: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üîç Data Collection Platform</h1>
            <p>–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram –∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</p>
        </div>

        <!-- Statistics -->
        <div class="data-section">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="telegramStats">0</div>
                    <div class="stat-label">Telegram –¥–∞–Ω–Ω—ã–µ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="browserStats">0</div>
                    <div class="stat-label">–ë—Ä–∞—É–∑–µ—Ä –¥–∞–Ω–Ω—ã–µ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="deviceStats">0</div>
                    <div class="stat-label">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã–µ</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="locationStats">0</div>
                    <div class="stat-label">–õ–æ–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã–µ</div>
                </div>
            </div>
            <div class="progress-section">
                <h3>–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
                <div class="progress-bar">
                    <div class="progress-fill" id="dataProgress" style="width: 0%">0%</div>
                </div>
            </div>
        </div>

        <!-- Telegram Data -->
        <div class="data-section">
            <h2>üì± –î–∞–Ω–Ω—ã–µ –∏–∑ Telegram</h2>
            <div class="data-grid">
                <div class="data-card">
                    <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                    <div class="data-item">
                        <span class="data-label">ID:</span>
                        <span class="data-value" id="telegramId">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ò–º—è:</span>
                        <span class="data-value" id="telegramName">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">Username:</span>
                        <span class="data-value" id="telegramUsername">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–Ø–∑—ã–∫:</span>
                        <span class="data-value" id="telegramLanguage">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">Premium:</span>
                        <span class="data-value" id="telegramPremium">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                </div>
                <div class="data-card">
                    <h3>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
                    <div class="data-item">
                        <span class="data-label">–ë–æ—Ç:</span>
                        <span class="data-value" id="telegramIsBot">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ú–µ–Ω—é –≤–ª–æ–∂–µ–Ω–∏–π:</span>
                        <span class="data-value" id="telegramAttachmentMenu">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π:</span>
                        <span class="data-value" id="telegramInteractions">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</span>
                        <span class="data-value" id="telegramLastActivity">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Data -->
        <div class="data-section">
            <h2>üí¨ –î–∞–Ω–Ω—ã–µ —á–∞—Ç–∞</h2>
            <div class="data-grid">
                <div class="data-card">
                    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ</h3>
                    <div class="data-item">
                        <span class="data-label">ID —á–∞—Ç–∞:</span>
                        <span class="data-value" id="chatId">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–¢–∏–ø —á–∞—Ç–∞:</span>
                        <span class="data-value" id="chatType">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ù–∞–∑–≤–∞–Ω–∏–µ:</span>
                        <span class="data-value" id="chatTitle">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">Username —á–∞—Ç–∞:</span>
                        <span class="data-value" id="chatUsername">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Browser Data -->
        <div class="data-section">
            <h2>üåê –î–∞–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä–∞</h2>
            <div class="data-grid">
                <div class="data-card">
                    <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±—Ä–∞—É–∑–µ—Ä–µ</h3>
                    <div class="data-item">
                        <span class="data-label">User Agent:</span>
                        <span class="data-value" id="userAgent">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–Ø–∑—ã–∫:</span>
                        <span class="data-value" id="browserLanguage">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</span>
                        <span class="data-value" id="platform">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞:</span>
                        <span class="data-value" id="screenResolution">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞:</span>
                        <span class="data-value" id="timezone">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                </div>
                <div class="data-card">
                    <h3>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ</h3>
                    <div class="data-item">
                        <span class="data-label">–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:</span>
                        <span class="data-value" id="deviceType">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–û–°:</span>
                        <span class="data-value" id="operatingSystem">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ë—Ä–∞—É–∑–µ—Ä:</span>
                        <span class="data-value" id="browserName">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–í–µ—Ä—Å–∏—è –±—Ä–∞—É–∑–µ—Ä–∞:</span>
                        <span class="data-value" id="browserVersion">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">WebGL:</span>
                        <span class="data-value" id="webglSupport">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Location Data -->
        <div class="data-section">
            <h2>üìç –î–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏</h2>
            <div class="data-grid">
                <div class="data-card">
                    <h3>–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è</h3>
                    <div class="data-item">
                        <span class="data-label">IP –∞–¥—Ä–µ—Å:</span>
                        <span class="data-value" id="ipAddress">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–°—Ç—Ä–∞–Ω–∞:</span>
                        <span class="data-value" id="country">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ì–æ—Ä–æ–¥:</span>
                        <span class="data-value" id="city">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</span>
                        <span class="data-value" id="coordinates">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ü—Ä–æ–≤–∞–π–¥–µ—Ä:</span>
                        <span class="data-value" id="isp">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bot Information -->
        <div class="data-section">
            <h2>ü§ñ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ</h2>
            <div class="data-grid">
                <div class="data-card">
                    <h3>–î–∞–Ω–Ω—ã–µ –±–æ—Ç–∞</h3>
                    <div class="data-item">
                        <span class="data-label">Username –±–æ—Ç–∞:</span>
                        <span class="data-value" id="botUsername">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ò–º—è –±–æ—Ç–∞:</span>
                        <span class="data-value" id="botFirstName">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ú–æ–∂–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è—Ç—å—Å—è –∫ –≥—Ä—É–ø–ø–∞–º:</span>
                        <span class="data-value" id="botCanJoinGroups">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ú–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è:</span>
                        <span class="data-value" id="botCanReadAllMessages">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                    <div class="data-item">
                        <span class="data-label">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç inline –∑–∞–ø—Ä–æ—Å—ã:</span>
                        <span class="data-value" id="botSupportsInline">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Timeline -->
        <div class="data-section">
            <h2>‚è∞ –í—Ä–µ–º–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h2>
            <div class="timeline" id="activityTimeline">
                <div class="no-data">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏...</div>
            </div>
        </div>

        <!-- Export Section -->
        <div class="data-section">
            <h2>üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h2>
            <p>–°–∫–∞—á–∞–π—Ç–µ –≤—Å–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö:</p>
            <div class="export-buttons">
                <button class="btn json" onclick="exportData('json')">üìÑ JSON</button>
                <button class="btn csv" onclick="exportData('csv')">üìä CSV</button>
                <button class="btn txt" onclick="exportData('txt')">üìù TXT</button>
                <button class="btn" onclick="printData()">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span id="notificationText">–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!</span>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
        let collectedData = {
            telegram: {},
            browser: {},
            device: {},
            location: {},
            bot: {},
            timeline: []
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        if (tg) {
            tg.ready();
            tg.expand();
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            notificationText.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –°–ë–û–† –î–ê–ù–ù–´–• –ë–†–ê–£–ó–ï–†–ê
        function collectBrowserData() {
            const userAgent = navigator.userAgent;
            
            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞ - –†–ê–°–®–ò–†–ï–ù–ù–û–ï
            let browserName = 'Unknown';
            let browserVersion = 'Unknown';
            let browserEngine = 'Unknown';
            
            if (userAgent.includes('Chrome')) {
                browserName = 'Chrome';
                browserVersion = userAgent.match(/Chrome\/(\d+)/)?.[1] || 'Unknown';
                browserEngine = 'Blink';
            } else if (userAgent.includes('Firefox')) {
                browserName = 'Firefox';
                browserVersion = userAgent.match(/Firefox\/(\d+)/)?.[1] || 'Unknown';
                browserEngine = 'Gecko';
            } else if (userAgent.includes('Safari')) {
                browserName = 'Safari';
                browserVersion = userAgent.match(/Version\/(\d+)/)?.[1] || 'Unknown';
                browserEngine = 'WebKit';
            } else if (userAgent.includes('Edge')) {
                browserName = 'Edge';
                browserVersion = userAgent.match(/Edge\/(\d+)/)?.[1] || 'Unknown';
                browserEngine = 'Blink';
            } else if (userAgent.includes('Opera')) {
                browserName = 'Opera';
                browserVersion = userAgent.match(/Opera\/(\d+)/)?.[1] || 'Unknown';
                browserEngine = 'Blink';
            }

            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –û–° - –†–ê–°–®–ò–†–ï–ù–ù–û–ï
            let operatingSystem = 'Unknown';
            let osVersion = 'Unknown';
            if (userAgent.includes('Windows NT 10.0')) {
                operatingSystem = 'Windows 10/11';
                osVersion = '10/11';
            } else if (userAgent.includes('Windows NT 6.3')) {
                operatingSystem = 'Windows 8.1';
                osVersion = '8.1';
            } else if (userAgent.includes('Windows NT 6.1')) {
                operatingSystem = 'Windows 7';
                osVersion = '7';
            } else if (userAgent.includes('Mac OS X')) {
                operatingSystem = 'macOS';
                osVersion = userAgent.match(/Mac OS X (\d+_\d+)/)?.[1]?.replace('_', '.') || 'Unknown';
            } else if (userAgent.includes('Linux')) {
                operatingSystem = 'Linux';
                osVersion = 'Unknown';
            } else if (userAgent.includes('Android')) {
                operatingSystem = 'Android';
                osVersion = userAgent.match(/Android (\d+\.\d+)/)?.[1] || 'Unknown';
            } else if (userAgent.includes('iOS')) {
                operatingSystem = 'iOS';
                osVersion = userAgent.match(/OS (\d+_\d+)/)?.[1]?.replace('_', '.') || 'Unknown';
            }

            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ - –†–ê–°–®–ò–†–ï–ù–ù–û–ï
            let deviceType = 'Desktop';
            let deviceModel = 'Unknown';
            if (userAgent.includes('Mobile')) {
                deviceType = 'Mobile';
                if (userAgent.includes('iPhone')) deviceModel = 'iPhone';
                else if (userAgent.includes('iPad')) deviceModel = 'iPad';
                else if (userAgent.includes('Android')) deviceModel = 'Android Device';
            } else if (userAgent.includes('Tablet')) {
                deviceType = 'Tablet';
                deviceModel = 'Tablet';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ WebGL - –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø
            let webglSupport = 'No';
            let webglVersion = 'None';
            let webglVendor = 'None';
            let webglRenderer = 'None';
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (gl) {
                    webglSupport = 'Yes';
                    webglVersion = gl.getParameter(gl.VERSION) || 'Unknown';
                    webglVendor = gl.getParameter(gl.VENDOR) || 'Unknown';
                    webglRenderer = gl.getParameter(gl.RENDERER) || 'Unknown';
                }
            } catch (e) {
                webglSupport = 'No';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ WebRTC
            let webrtcSupport = 'No';
            try {
                webrtcSupport = !!(window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection) ? 'Yes' : 'No';
            } catch (e) {
                webrtcSupport = 'No';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ WebSocket
            let websocketSupport = 'No';
            try {
                websocketSupport = window.WebSocket ? 'Yes' : 'No';
            } catch (e) {
                websocketSupport = 'No';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Service Workers
            let serviceWorkerSupport = 'No';
            try {
                serviceWorkerSupport = 'serviceWorker' in navigator ? 'Yes' : 'No';
            } catch (e) {
                serviceWorkerSupport = 'No';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Push Notifications
            let pushNotificationSupport = 'No';
            try {
                pushNotificationSupport = 'PushManager' in window ? 'Yes' : 'No';
            } catch (e) {
                pushNotificationSupport = 'No';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Geolocation
            let geolocationSupport = 'No';
            try {
                geolocationSupport = 'geolocation' in navigator ? 'Yes' : 'No';
            } catch (e) {
                geolocationSupport = 'No';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Camera
            let cameraSupport = 'No';
            try {
                cameraSupport = navigator.mediaDevices && navigator.mediaDevices.getUserMedia ? 'Yes' : 'No';
            } catch (e) {
                cameraSupport = 'No';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Microphone
            let microphoneSupport = 'No';
            try {
                microphoneSupport = navigator.mediaDevices && navigator.mediaDevices.getUserMedia ? 'Yes' : 'No';
            } catch (e) {
                microphoneSupport = 'No';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Sensors
            let sensorSupport = {};
            try {
                sensorSupport.accelerometer = 'Accelerometer' in window ? 'Yes' : 'No';
                sensorSupport.gyroscope = 'Gyroscope' in window ? 'Yes' : 'No';
                sensorSupport.magnetometer = 'Magnetometer' in window ? 'Yes' : 'No';
                sensorSupport.linearAccelerationSensor = 'LinearAccelerationSensor' in window ? 'Yes' : 'No';
                sensorSupport.gravitySensor = 'GravitySensor' in window ? 'Yes' : 'No';
            } catch (e) {
                sensorSupport = { error: 'Sensors not supported' };
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Battery API
            let batterySupport = 'No';
            let batteryLevel = 'Unknown';
            let batteryCharging = 'Unknown';
            try {
                if ('getBattery' in navigator) {
                    batterySupport = 'Yes';
                    navigator.getBattery().then(battery => {
                        batteryLevel = Math.round(battery.level * 100) + '%';
                        batteryCharging = battery.charging ? 'Yes' : 'No';
                    });
                }
            } catch (e) {
                batterySupport = 'No';
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Connection API
            let connectionInfo = {};
            try {
                if ('connection' in navigator) {
                    connectionInfo.effectiveType = navigator.connection.effectiveType || 'Unknown';
                    connectionInfo.downlink = navigator.connection.downlink || 'Unknown';
                    connectionInfo.rtt = navigator.connection.rtt || 'Unknown';
                    connectionInfo.saveData = navigator.connection.saveData || 'Unknown';
                }
            } catch (e) {
                connectionInfo = { error: 'Connection API not supported' };
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Memory API
            let memoryInfo = {};
            try {
                if ('memory' in performance) {
                    memoryInfo.totalJSHeapSize = performance.memory.totalJSHeapSize || 'Unknown';
                    memoryInfo.usedJSHeapSize = performance.memory.usedJSHeapSize || 'Unknown';
                    memoryInfo.jsHeapSizeLimit = performance.memory.jsHeapSizeLimit || 'Unknown';
                }
            } catch (e) {
                memoryInfo = { error: 'Memory API not supported' };
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Hardware Concurrency
            let hardwareConcurrency = navigator.hardwareConcurrency || 'Unknown';

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Device Memory
            let deviceMemory = navigator.deviceMemory || 'Unknown';

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Max Touch Points
            let maxTouchPoints = navigator.maxTouchPoints || 'Unknown';

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Cookie Support
            let cookieEnabled = navigator.cookieEnabled;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Do Not Track
            let doNotTrack = navigator.doNotTrack || 'Unknown';

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Online Status
            let onlineStatus = navigator.onLine;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Language Support
            let languages = navigator.languages || [navigator.language];

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ Permissions API
            let permissionsSupport = 'No';
            try {
                permissionsSupport = 'permissions' in navigator ? 'Yes' : 'No';
            } catch (e) {
                permissionsSupport = 'No';
            }

            return {
                // –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                userAgent: userAgent,
                language: navigator.language,
                languages: languages,
                platform: navigator.platform,
                cookieEnabled: cookieEnabled,
                doNotTrack: doNotTrack,
                onlineStatus: onlineStatus,
                
                // –†–∞–∑–º–µ—Ä—ã —ç–∫—Ä–∞–Ω–∞
                screenWidth: screen.width,
                screenHeight: screen.height,
                screenColorDepth: screen.colorDepth,
                screenPixelDepth: screen.pixelDepth,
                screenAvailWidth: screen.availWidth,
                screenAvailHeight: screen.availHeight,
                
                // –†–∞–∑–º–µ—Ä—ã –æ–∫–Ω–∞
                windowWidth: window.innerWidth,
                windowHeight: window.innerHeight,
                windowOuterWidth: window.outerWidth,
                windowOuterHeight: window.outerHeight,
                
                // –í—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                timezoneOffset: new Date().getTimezoneOffset(),
                
                // –ë—Ä–∞—É–∑–µ—Ä
                browserName,
                browserVersion,
                browserEngine,
                operatingSystem,
                osVersion,
                deviceType,
                deviceModel,
                
                // WebGL
                webglSupport,
                webglVersion,
                webglVendor,
                webglRenderer,
                
                // API Support
                webrtcSupport,
                websocketSupport,
                serviceWorkerSupport,
                pushNotificationSupport,
                geolocationSupport,
                cameraSupport,
                microphoneSupport,
                permissionsSupport,
                
                // Sensors
                sensorSupport,
                
                // Battery
                batterySupport,
                batteryLevel,
                batteryCharging,
                
                // Connection
                connectionInfo,
                
                // Memory
                memoryInfo,
                
                // Hardware
                hardwareConcurrency,
                deviceMemory,
                maxTouchPoints,
                
                // Timestamp
                timestamp: new Date().toISOString(),
                timestampUTC: new Date().toUTCString(),
                timestampLocal: new Date().toLocaleString()
            };
        }

        // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö Telegram Web App
        function collectTelegramData() {
            if (tg && tg.initDataUnsafe) {
                const user = tg.initDataUnsafe.user;
                if (user) {
                    return {
                        id: user.id,
                        firstName: user.first_name,
                        lastName: user.last_name,
                        username: user.username,
                        languageCode: user.language_code,
                        isPremium: user.is_premium || false,
                        isBot: user.is_bot || false,
                        addedToAttachmentMenu: user.added_to_attachment_menu || false
                    };
                }
            }
            return {};
        }

        // –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –°–ë–û–† –ì–ï–û–õ–û–ö–ê–¶–ò–ò –ò –õ–û–ö–ê–¶–ò–ò
        async function collectLocationData() {
            let locationData = {
                ip: 'Unknown',
                city: 'Unknown',
                region: 'Unknown',
                country: 'Unknown',
                countryCode: 'Unknown',
                latitude: 'Unknown',
                longitude: 'Unknown',
                timezone: 'Unknown',
                isp: 'Unknown',
                asn: 'Unknown',
                accuracy: 'Unknown',
                source: 'Unknown'
            };

            // –ü–æ–ª—É—á–µ–Ω–∏–µ IP –∏ –±–∞–∑–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                locationData = {
                    ...locationData,
                    ip: data.ip,
                    city: data.city,
                    region: data.region,
                    country: data.country_name,
                    countryCode: data.country_code,
                    latitude: data.latitude,
                    longitude: data.longitude,
                    timezone: data.timezone,
                    isp: data.org,
                    asn: data.asn,
                    source: 'ipapi.co'
                };
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–∏:', error);
            }

            // –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—É—é –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
            if (navigator.geolocation) {
                try {
                    const position = await new Promise((resolve, reject) => {
                        navigator.geolocation.getCurrentPosition(resolve, reject, {
                            enableHighAccuracy: true,
                            timeout: 10000,
                            maximumAge: 60000
                        });
                    });

                    locationData = {
                        ...locationData,
                        latitude: position.coords.latitude,
                        longitude: position.coords.longitude,
                        accuracy: position.coords.accuracy,
                        altitude: position.coords.altitude,
                        altitudeAccuracy: position.coords.altitudeAccuracy,
                        heading: position.coords.heading,
                        speed: position.coords.speed,
                        timestamp: position.timestamp,
                        source: 'GPS'
                    };
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è GPS –¥–∞–Ω–Ω—ã—Ö:', error);
                }
            }

            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–µ–º–µ–Ω–∏
            locationData.currentTime = new Date().toISOString();
            locationData.timezoneOffset = new Date().getTimezoneOffset();
            locationData.timezoneName = Intl.DateTimeFormat().resolvedOptions().timeZone;

            return locationData;
        }

        // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function collectBehaviorData() {
            let behaviorData = {
                mouseMovements: 0,
                clicks: 0,
                keyPresses: 0,
                scrollEvents: 0,
                touchEvents: 0,
                focusEvents: 0,
                blurEvents: 0,
                resizeEvents: 0,
                orientationChanges: 0,
                visibilityChanges: 0,
                sessionStart: new Date().toISOString(),
                lastActivity: new Date().toISOString()
            };

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏–π –º—ã—à–∏
            document.addEventListener('mousemove', () => {
                behaviorData.mouseMovements++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤
            document.addEventListener('click', () => {
                behaviorData.clicks++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à
            document.addEventListener('keydown', () => {
                behaviorData.keyPresses++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–∫—Ä–æ–ª–ª–∞
            document.addEventListener('scroll', () => {
                behaviorData.scrollEvents++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞—Å–∞–Ω–∏–π
            document.addEventListener('touchstart', () => {
                behaviorData.touchEvents++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ñ–æ–∫—É—Å–∞
            document.addEventListener('focus', () => {
                behaviorData.focusEvents++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ —Ñ–æ–∫—É—Å–∞
            document.addEventListener('blur', () => {
                behaviorData.blurEvents++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞
            window.addEventListener('resize', () => {
                behaviorData.resizeEvents++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
            window.addEventListener('orientationchange', () => {
                behaviorData.orientationChanges++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.addEventListener('visibilitychange', () => {
                behaviorData.visibilityChanges++;
                behaviorData.lastActivity = new Date().toISOString();
            });

            return behaviorData;
        }

        // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function collectPerformanceData() {
            let performanceData = {};

            try {
                // Navigation Timing
                const navigation = performance.getEntriesByType('navigation')[0];
                if (navigation) {
                    performanceData.navigation = {
                        loadEventEnd: navigation.loadEventEnd,
                        loadEventStart: navigation.loadEventStart,
                        domContentLoadedEventEnd: navigation.domContentLoadedEventEnd,
                        domContentLoadedEventStart: navigation.domContentLoadedEventStart,
                        domComplete: navigation.domComplete,
                        domInteractive: navigation.domInteractive,
                        domLoading: navigation.domLoading,
                        fetchStart: navigation.fetchStart,
                        navigationStart: navigation.navigationStart,
                        redirectEnd: navigation.redirectEnd,
                        redirectStart: navigation.redirectStart,
                        requestStart: navigation.requestStart,
                        responseEnd: navigation.responseEnd,
                        responseStart: navigation.responseStart,
                        secureConnectionStart: navigation.secureConnectionStart,
                        unloadEventEnd: navigation.unloadEventEnd,
                        unloadEventStart: navigation.unloadEventStart
                    };
                }

                // Resource Timing
                const resources = performance.getEntriesByType('resource');
                performanceData.resources = resources.length;
                performanceData.resourceTimings = resources.map(resource => ({
                    name: resource.name,
                    duration: resource.duration,
                    startTime: resource.startTime,
                    transferSize: resource.transferSize,
                    encodedBodySize: resource.encodedBodySize,
                    decodedBodySize: resource.decodedBodySize
                }));

                // Paint Timing
                const paintEntries = performance.getEntriesByType('paint');
                performanceData.paint = {};
                paintEntries.forEach(entry => {
                    performanceData.paint[entry.name] = entry.startTime;
                });

                // Memory (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
                if (performance.memory) {
                    performanceData.memory = {
                        totalJSHeapSize: performance.memory.totalJSHeapSize,
                        usedJSHeapSize: performance.memory.usedJSHeapSize,
                        jsHeapSizeLimit: performance.memory.jsHeapSizeLimit
                    };
                }

                // Timing
                performanceData.timing = {
                    now: performance.now(),
                    timeOrigin: performance.timeOrigin
                };

            } catch (error) {
                performanceData.error = error.message;
            }

            return performanceData;
        }

        // –®–ï–†–õ–û–ö - –§–£–ù–ö–¶–ò–ò –ì–õ–£–ë–û–ö–û–ì–û –ê–ù–ê–õ–ò–ó–ê
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Canvas –æ—Ç–ø–µ—á–∞—Ç–∫–∞
        function generateCanvasFingerprint() {
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = 200;
                canvas.height = 50;
                
                // –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillStyle = '#f60';
                ctx.fillRect(125, 1, 62, 20);
                ctx.fillStyle = '#069';
                ctx.fillText('Canvas fingerprint', 2, 15);
                ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';
                ctx.fillText('Canvas fingerprint', 4, 17);
                
                return canvas.toDataURL();
            } catch (e) {
                return 'Canvas not supported';
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è WebGL –æ—Ç–ø–µ—á–∞—Ç–∫–∞
        function generateWebGLFingerprint() {
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (!gl) return 'WebGL not supported';
                
                return {
                    version: gl.getParameter(gl.VERSION),
                    vendor: gl.getParameter(gl.VENDOR),
                    renderer: gl.getParameter(gl.RENDERER),
                    shadingLanguageVersion: gl.getParameter(gl.SHADING_LANGUAGE_VERSION),
                    extensions: gl.getSupportedExtensions()
                };
            } catch (e) {
                return 'WebGL error: ' + e.message;
            }
        }

        // –ù–ï–í–ï–†–û–Ø–¢–ù–û –ú–û–©–ù–ê–Ø –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Audio –æ—Ç–ø–µ—á–∞—Ç–∫–∞
        function generateAudioFingerprint() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const analyser = audioContext.createAnalyser();
                const gainNode = audioContext.createGain();
                const scriptProcessor = audioContext.createScriptProcessor(4096, 1, 1);
                
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(10000, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                
                oscillator.connect(analyser);
                analyser.connect(scriptProcessor);
                scriptProcessor.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // –°–æ–±–∏—Ä–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                const fingerprint = {
                    sampleRate: audioContext.sampleRate,
                    maxChannelCount: audioContext.destination.maxChannelCount,
                    numberOfInputs: audioContext.destination.numberOfInputs,
                    numberOfOutputs: audioContext.destination.numberOfOutputs,
                    channelCount: audioContext.destination.channelCount,
                    channelCountMode: audioContext.destination.channelCountMode,
                    channelInterpretation: audioContext.destination.channelInterpretation,
                    contextState: audioContext.state,
                    baseLatency: audioContext.baseLatency,
                    outputLatency: audioContext.outputLatency,
                    timestamp: Date.now()
                };
                
                return fingerprint;
            } catch (e) {
                return {
                    error: 'Audio not supported',
                    message: e.message,
                    timestamp: Date.now()
                };
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Font –æ—Ç–ø–µ—á–∞—Ç–∫–∞
        function generateFontFingerprint() {
            const testString = 'abcdefghijklmnopqrstuvwxyz0123456789';
            const testSize = '72px';
            const h = document.getElementsByTagName('body')[0];
            const s = document.createElement('span');
            s.style.fontSize = testSize;
            s.innerHTML = testString;
            const defaultWidth = {};
            const defaultHeight = {};
            
            const fonts = [
                'Arial', 'Verdana', 'Times New Roman', 'Courier New', 'Helvetica',
                'Georgia', 'Palatino', 'Garamond', 'Bookman', 'Comic Sans MS',
                'Trebuchet MS', 'Arial Black', 'Impact'
            ];
            
            const fingerprint = {};
            fonts.forEach(font => {
                s.style.fontFamily = font;
                h.appendChild(s);
                fingerprint[font] = {
                    width: s.offsetWidth,
                    height: s.offsetHeight
                };
                h.removeChild(s);
            });
            
            return fingerprint;
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Screen –æ—Ç–ø–µ—á–∞—Ç–∫–∞
        function generateScreenFingerprint() {
            return {
                width: screen.width,
                height: screen.height,
                availWidth: screen.availWidth,
                availHeight: screen.availHeight,
                colorDepth: screen.colorDepth,
                pixelDepth: screen.pixelDepth,
                orientation: screen.orientation ? screen.orientation.type : 'unknown'
            };
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Timezone –æ—Ç–ø–µ—á–∞—Ç–∫–∞
        function generateTimezoneFingerprint() {
            return {
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                offset: new Date().getTimezoneOffset(),
                locale: Intl.DateTimeFormat().resolvedOptions().locale,
                calendar: Intl.DateTimeFormat().resolvedOptions().calendar,
                numberingSystem: Intl.DateTimeFormat().resolvedOptions().numberingSystem
            };
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Language –æ—Ç–ø–µ—á–∞—Ç–∫–∞
        function generateLanguageFingerprint() {
            return {
                language: navigator.language,
                languages: navigator.languages,
                platform: navigator.platform,
                userAgent: navigator.userAgent,
                cookieEnabled: navigator.cookieEnabled,
                doNotTrack: navigator.doNotTrack,
                onLine: navigator.onLine
            };
        }

        // –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –ø–µ—á–∞—Ç–∏
        function analyzeTypingPattern() {
            let typingData = {
                keystrokes: 0,
                backspaces: 0,
                pauses: [],
                rhythm: [],
                startTime: Date.now()
            };
            
            document.addEventListener('keydown', (e) => {
                typingData.keystrokes++;
                if (e.key === 'Backspace') typingData.backspaces++;
                typingData.rhythm.push(Date.now() - typingData.startTime);
            });
            
            return typingData;
        }

        // –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –º—ã—à–∏
        function analyzeMousePattern() {
            let mouseData = {
                movements: 0,
                clicks: 0,
                rightClicks: 0,
                scrolls: 0,
                path: [],
                speed: [],
                acceleration: []
            };
            
            document.addEventListener('mousemove', (e) => {
                mouseData.movements++;
                mouseData.path.push({x: e.clientX, y: e.clientY, time: Date.now()});
            });
            
            document.addEventListener('click', (e) => {
                mouseData.clicks++;
            });
            
            document.addEventListener('contextmenu', (e) => {
                mouseData.rightClicks++;
            });
            
            document.addEventListener('wheel', (e) => {
                mouseData.scrolls++;
            });
            
            return mouseData;
        }

        // –ê–Ω–∞–ª–∏–∑ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞
        function analyzeScrollBehavior() {
            let scrollData = {
                scrolls: 0,
                direction: [],
                speed: [],
                position: [],
                time: []
            };
            
            document.addEventListener('scroll', (e) => {
                scrollData.scrolls++;
                scrollData.direction.push(window.scrollY > scrollData.lastY ? 'down' : 'up');
                scrollData.speed.push(Math.abs(window.scrollY - scrollData.lastY));
                scrollData.position.push(window.scrollY);
                scrollData.time.push(Date.now());
                scrollData.lastY = window.scrollY;
            });
            
            return scrollData;
        }

        // –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –∫–ª–∏–∫–æ–≤
        function analyzeClickPattern() {
            let clickData = {
                clicks: 0,
                doubleClicks: 0,
                positions: [],
                intervals: [],
                pressure: []
            };
            
            document.addEventListener('click', (e) => {
                clickData.clicks++;
                clickData.positions.push({x: e.clientX, y: e.clientY});
            });
            
            document.addEventListener('dblclick', (e) => {
                clickData.doubleClicks++;
            });
            
            return clickData;
        }

        // –ê–Ω–∞–ª–∏–∑ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Ñ–æ–∫—É—Å–∞
        function analyzeFocusBehavior() {
            let focusData = {
                focusEvents: 0,
                blurEvents: 0,
                focusDuration: [],
                elements: []
            };
            
            document.addEventListener('focus', (e) => {
                focusData.focusEvents++;
                focusData.elements.push(e.target.tagName);
            });
            
            document.addEventListener('blur', (e) => {
                focusData.blurEvents++;
            });
            
            return focusData;
        }

        // –†–∞—Å—á–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–∏
        function calculateSessionDuration() {
            return {
                startTime: Date.now(),
                currentDuration: 0,
                isActive: true
            };
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        function generateActivityHeatmap() {
            return {
                mouseMovements: 0,
                clicks: 0,
                scrolls: 0,
                keystrokes: 0,
                focusChanges: 0,
                timestamp: Date.now()
            };
        }

        // –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        function classifyDevice() {
            const userAgent = navigator.userAgent;
            let classification = {
                type: 'unknown',
                category: 'unknown',
                capabilities: [],
                limitations: []
            };
            
            if (userAgent.includes('Mobile')) {
                classification.type = 'mobile';
                classification.category = 'smartphone';
                classification.capabilities = ['touch', 'gyroscope', 'accelerometer'];
            } else if (userAgent.includes('Tablet')) {
                classification.type = 'tablet';
                classification.category = 'tablet';
                classification.capabilities = ['touch', 'gyroscope', 'accelerometer'];
            } else {
                classification.type = 'desktop';
                classification.category = 'computer';
                classification.capabilities = ['mouse', 'keyboard', 'large_screen'];
            }
            
            return classification;
        }

        // –û—Ü–µ–Ω–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
        function assessCapabilities() {
            return {
                webgl: !!document.createElement('canvas').getContext('webgl'),
                webgl2: !!document.createElement('canvas').getContext('webgl2'),
                webRTC: !!(window.RTCPeerConnection || window.mozRTCPeerConnection),
                webSocket: !!window.WebSocket,
                serviceWorker: 'serviceWorker' in navigator,
                pushManager: 'PushManager' in window,
                geolocation: 'geolocation' in navigator,
                mediaDevices: !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia),
                battery: 'getBattery' in navigator,
                connection: 'connection' in navigator,
                memory: 'memory' in performance
            };
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function createPerformanceProfile() {
            return {
                hardwareConcurrency: navigator.hardwareConcurrency || 'unknown',
                deviceMemory: navigator.deviceMemory || 'unknown',
                maxTouchPoints: navigator.maxTouchPoints || 0,
                performanceScore: calculatePerformanceScore(),
                capabilities: assessCapabilities()
            };
        }

        // –û—Ü–µ–Ω–∫–∞ –∂–µ–ª–µ–∑–∞
        function estimateHardware() {
            return {
                cores: navigator.hardwareConcurrency || 'unknown',
                memory: navigator.deviceMemory || 'unknown',
                touchPoints: navigator.maxTouchPoints || 0,
                screenSize: screen.width + 'x' + screen.height,
                colorDepth: screen.colorDepth,
                pixelRatio: window.devicePixelRatio || 1
            };
        }

        // –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–∏
        function analyzeNetwork() {
            let networkInfo = {
                connectionType: 'unknown',
                effectiveType: 'unknown',
                downlink: 'unknown',
                rtt: 'unknown',
                saveData: 'unknown'
            };
            
            if ('connection' in navigator) {
                const conn = navigator.connection;
                networkInfo.connectionType = conn.type || 'unknown';
                networkInfo.effectiveType = conn.effectiveType || 'unknown';
                networkInfo.downlink = conn.downlink || 'unknown';
                networkInfo.rtt = conn.rtt || 'unknown';
                networkInfo.saveData = conn.saveData || 'unknown';
            }
            
            return networkInfo;
        }

        // –û—Ü–µ–Ω–∫–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏
        function assessTechSavviness() {
            let score = 0;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö API
            if (navigator.serviceWorker) score += 2;
            if (navigator.mediaDevices) score += 2;
            if (navigator.geolocation) score += 1;
            if (navigator.getBattery) score += 1;
            if (navigator.connection) score += 1;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±—Ä–∞—É–∑–µ—Ä
            if (navigator.userAgent.includes('Chrome')) score += 3;
            else if (navigator.userAgent.includes('Firefox')) score += 2;
            else if (navigator.userAgent.includes('Safari')) score += 1;
            
            return {
                score: score,
                level: score > 8 ? 'high' : score > 4 ? 'medium' : 'low',
                indicators: ['modern_apis', 'browser_choice', 'feature_usage']
            };
        }

        // –û—Ü–µ–Ω–∫–∞ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
        function assessPrivacyConsciousness() {
            let score = 0;
            
            if (navigator.doNotTrack === '1') score += 3;
            if (navigator.cookieEnabled === false) score += 2;
            if (navigator.userAgent.includes('Tor')) score += 5;
            if (navigator.userAgent.includes('VPN')) score += 3;
            
            return {
                score: score,
                level: score > 8 ? 'high' : score > 4 ? 'medium' : 'low',
                indicators: ['dnt_enabled', 'cookies_disabled', 'privacy_tools']
            };
        }

        // –ê–Ω–∞–ª–∏–∑ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        function analyzeDevicePreference() {
            return {
                deviceType: navigator.userAgent.includes('Mobile') ? 'mobile' : 'desktop',
                browser: navigator.userAgent.includes('Chrome') ? 'chrome' : 'other',
                os: navigator.userAgent.includes('Windows') ? 'windows' : 'other',
                privacy: navigator.doNotTrack === '1' ? 'privacy_conscious' : 'standard'
            };
        }

        // –ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        function analyzeUsagePatterns() {
            return {
                sessionLength: Date.now() - performance.timeOrigin,
                interactions: 0,
                pages: 1,
                timeOnPage: Date.now() - performance.timeOrigin,
                behavior: 'analyzing'
            };
        }

        // –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ñ–∏–ª—è —Ä–∏—Å–∫–∞
        function calculateRiskProfile() {
            let riskScore = 0;
            
            // –§–∞–∫—Ç–æ—Ä—ã —Ä–∏—Å–∫–∞
            if (navigator.userAgent.includes('bot')) riskScore += 5;
            if (navigator.userAgent.includes('crawler')) riskScore += 3;
            if (navigator.userAgent.includes('spider')) riskScore += 3;
            if (navigator.doNotTrack === '1') riskScore -= 2;
            if (navigator.cookieEnabled === false) riskScore -= 1;
            
            return {
                score: riskScore,
                level: riskScore > 5 ? 'high' : riskScore > 2 ? 'medium' : 'low',
                factors: ['bot_indicators', 'privacy_settings', 'behavior_patterns']
            };
        }

        // –û—Ü–µ–Ω–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
        function assessVulnerabilities() {
            return {
                outdatedBrowser: navigator.userAgent.includes('MSIE') || navigator.userAgent.includes('Trident'),
                noHttps: window.location.protocol !== 'https:',
                noCSP: !document.querySelector('meta[http-equiv="Content-Security-Policy"]'),
                trackingEnabled: navigator.cookieEnabled,
                riskLevel: 'medium'
            };
        }

        // –†–∞—Å—á–µ—Ç —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
        function calculatePrivacyExposure() {
            return {
                cookies: document.cookie.length,
                localStorage: Object.keys(localStorage).length,
                sessionStorage: Object.keys(sessionStorage).length,
                tracking: navigator.cookieEnabled,
                fingerprinting: 'high',
                exposure: 'medium'
            };
        }

        // –û—Ü–µ–Ω–∫–∞ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—é
        function assessTrackingResistance() {
            return {
                dnt: navigator.doNotTrack === '1',
                cookies: !navigator.cookieEnabled,
                fingerprinting: 'detected',
                resistance: 'low'
            };
        }

        // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        function identifySecurityIndicators() {
            return {
                https: window.location.protocol === 'https:',
                csp: !!document.querySelector('meta[http-equiv="Content-Security-Policy"]'),
                hsts: !!document.querySelector('meta[http-equiv="Strict-Transport-Security"]'),
                xss: 'detected',
                csrf: 'detected'
            };
        }

        // –†–∞—Å—á–µ—Ç —É—Ä–æ–≤–Ω—è —É–≥—Ä–æ–∑—ã
        function calculateThreatLevel() {
            return {
                level: 'medium',
                factors: ['fingerprinting', 'tracking', 'data_collection'],
                risk: 'moderate'
            };
        }

        // –†–∞—Å—á–µ—Ç –æ—Ü–µ–Ω–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function calculatePerformanceScore() {
            let score = 0;
            
            if (navigator.hardwareConcurrency > 4) score += 3;
            if (navigator.deviceMemory > 4) score += 2;
            if (navigator.maxTouchPoints > 0) score += 1;
            
            return score;
        }

        // –ù–ï–í–ï–†–û–Ø–¢–ù–û –ú–û–©–ù–´–ï –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò –°–ë–û–†–ê –î–ê–ù–ù–´–•
        
        // CSS –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        function generateCSSFingerprint() {
            const fingerprint = {
                computed_styles: {},
                media_queries: [],
                css_features: {},
                layout_engine: 'unknown'
            };
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º CSS –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                const testEl = document.createElement('div');
                const styles = [
                    'transform', 'transition', 'animation', 'flexbox', 'grid',
                    'box-shadow', 'text-shadow', 'border-radius', 'opacity',
                    'filter', 'backdrop-filter', 'clip-path', 'mask'
                ];
                
                styles.forEach(style => {
                    fingerprint.css_features[style] = style in testEl.style;
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã
                const mediaQueries = [
                    '(max-width: 768px)', '(min-width: 1024px)', '(orientation: portrait)',
                    '(prefers-color-scheme: dark)', '(prefers-reduced-motion: reduce)',
                    '(hover: hover)', '(pointer: fine)', '(pointer: coarse)'
                ];
                
                mediaQueries.forEach(mq => {
                    fingerprint.media_queries.push({
                        query: mq,
                        matches: window.matchMedia(mq).matches
                    });
                });
                
            } catch (e) {
                fingerprint.error = e.message;
            }
            
            return fingerprint;
        }
        
        // DOM –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        function generateDOMFingerprint() {
            const fingerprint = {
                dom_depth: document.documentElement.querySelectorAll('*').length,
                dom_elements: {
                    total: document.querySelectorAll('*').length,
                    by_tag: {},
                    by_class: {},
                    by_id: {}
                },
                dom_features: {},
                dom_apis: {}
            };
            
            try {
                // –°—á–∏—Ç–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ —Ç–µ–≥–∞–º
                const tags = ['div', 'span', 'p', 'a', 'img', 'input', 'button', 'form'];
                tags.forEach(tag => {
                    fingerprint.dom_elements.by_tag[tag] = document.querySelectorAll(tag).length;
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º DOM API
                const domAPIs = [
                    'querySelector', 'querySelectorAll', 'getElementById', 'getElementsByClassName',
                    'getElementsByTagName', 'createElement', 'appendChild', 'removeChild',
                    'addEventListener', 'removeEventListener', 'dispatchEvent'
                ];
                
                domAPIs.forEach(api => {
                    fingerprint.dom_apis[api] = api in document;
                });
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º DOM –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                fingerprint.dom_features = {
                    has_localStorage: 'localStorage' in window,
                    has_sessionStorage: 'sessionStorage' in window,
                    has_indexedDB: 'indexedDB' in window,
                    has_webSQL: 'openDatabase' in window,
                    has_fileAPI: 'FileReader' in window,
                    has_dragDrop: 'draggable' in document.createElement('div'),
                    has_contentEditable: 'contentEditable' in document.createElement('div')
                };
                
            } catch (e) {
                fingerprint.error = e.message;
            }
            
            return fingerprint;
        }
        
        // Timing –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        function generateTimingFingerprint() {
            const fingerprint = {
                performance_timing: {},
                performance_entries: {},
                timing_accuracy: 0,
                clock_skew: 0
            };
            
            try {
                // Performance Timing
                if (performance.timing) {
                    fingerprint.performance_timing = {
                        navigationStart: performance.timing.navigationStart,
                        loadEventEnd: performance.timing.loadEventEnd,
                        domContentLoadedEventEnd: performance.timing.domContentLoadedEventEnd,
                        responseEnd: performance.timing.responseEnd,
                        responseStart: performance.timing.responseStart
                    };
                }
                
                // Performance Entries
                const entries = performance.getEntries();
                fingerprint.performance_entries = {
                    total_entries: entries.length,
                    navigation_entries: performance.getEntriesByType('navigation').length,
                    resource_entries: performance.getEntriesByType('resource').length,
                    paint_entries: performance.getEntriesByType('paint').length,
                    measure_entries: performance.getEntriesByType('measure').length
                };
                
                // Timing accuracy
                fingerprint.timing_accuracy = performance.now();
                
                // Clock skew (—Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É local time –∏ server time)
                fingerprint.clock_skew = Date.now() - performance.timeOrigin;
                
            } catch (e) {
                fingerprint.error = e.message;
            }
            
            return fingerprint;
        }
        
        // Network –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        function generateNetworkFingerprint() {
            const fingerprint = {
                connection_info: {},
                network_apis: {},
                network_capabilities: {},
                network_timing: {}
            };
            
            try {
                // Connection API
                if ('connection' in navigator) {
                    const conn = navigator.connection;
                    fingerprint.connection_info = {
                        effectiveType: conn.effectiveType,
                        downlink: conn.downlink,
                        rtt: conn.rtt,
                        saveData: conn.saveData,
                        type: conn.type
                    };
                }
                
                // Network APIs
                fingerprint.network_apis = {
                    fetch: 'fetch' in window,
                    xhr: 'XMLHttpRequest' in window,
                    websocket: 'WebSocket' in window,
                    webrtc: 'RTCPeerConnection' in window,
                    server_sent_events: 'EventSource' in window
                };
                
                // Network capabilities
                fingerprint.network_capabilities = {
                    online: navigator.onLine,
                    cookie_enabled: navigator.cookieEnabled,
                    do_not_track: navigator.doNotTrack,
                    language: navigator.language,
                    languages: navigator.languages
                };
                
                // Network timing
                fingerprint.network_timing = {
                    timestamp: Date.now(),
                    timezone_offset: new Date().getTimezoneOffset(),
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
                };
                
            } catch (e) {
                fingerprint.error = e.message;
            }
            
            return fingerprint;
        }
        
        // Storage –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        function generateStorageFingerprint() {
            const fingerprint = {
                storage_available: {},
                storage_usage: {},
                storage_apis: {},
                storage_capabilities: {}
            };
            
            try {
                // Storage availability
                fingerprint.storage_available = {
                    localStorage: 'localStorage' in window,
                    sessionStorage: 'sessionStorage' in window,
                    indexedDB: 'indexedDB' in window,
                    webSQL: 'openDatabase' in window,
                    cache: 'caches' in window
                };
                
                // Storage usage
                if ('localStorage' in window) {
                    fingerprint.storage_usage.localStorage = {
                        keys: Object.keys(localStorage).length,
                        size: JSON.stringify(localStorage).length,
                        quota: 'storage' in navigator ? navigator.storage.estimate() : 'unknown'
                    };
                }
                
                if ('sessionStorage' in window) {
                    fingerprint.storage_usage.sessionStorage = {
                        keys: Object.keys(sessionStorage).length,
                        size: JSON.stringify(sessionStorage).length
                    };
                }
                
                // Storage APIs
                fingerprint.storage_apis = {
                    storage_event: 'storage' in window,
                    storage_quota: 'storage' in navigator,
                    storage_manager: 'storage' in navigator && 'getStorage' in navigator.storage
                };
                
                // Storage capabilities
                fingerprint.storage_capabilities = {
                    persistent: 'storage' in navigator && 'persist' in navigator.storage,
                    quota_estimation: 'storage' in navigator && 'estimate' in navigator.storage,
                    storage_events: 'storage' in window
                };
                
            } catch (e) {
                fingerprint.error = e.message;
            }
            
            return fingerprint;
        }
        
        // Media –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        function generateMediaFingerprint() {
            const fingerprint = {
                media_devices: {},
                media_capabilities: {},
                media_apis: {},
                media_constraints: {}
            };
            
            try {
                // Media devices
                if (navigator.mediaDevices) {
                    fingerprint.media_devices = {
                        getUserMedia: 'getUserMedia' in navigator.mediaDevices,
                        enumerateDevices: 'enumerateDevices' in navigator.mediaDevices,
                        getDisplayMedia: 'getDisplayMedia' in navigator.mediaDevices
                    };
                }
                
                // Media capabilities
                fingerprint.media_capabilities = {
                    video: 'video' in document.createElement('video'),
                    audio: 'audio' in document.createElement('audio'),
                    canvas: 'canvas' in document.createElement('canvas'),
                    webgl: 'webgl' in document.createElement('canvas'),
                    webgl2: 'webgl2' in document.createElement('canvas')
                };
                
                // Media APIs
                fingerprint.media_apis = {
                    mediaDevices: 'mediaDevices' in navigator,
                    getUserMedia: 'getUserMedia' in navigator,
                    webkitGetUserMedia: 'webkitGetUserMedia' in navigator,
                    mozGetUserMedia: 'mozGetUserMedia' in navigator,
                    msGetUserMedia: 'msGetUserMedia' in navigator
                };
                
                // Media constraints
                fingerprint.media_constraints = {
                    video_constraints: {
                        width: { min: 320, ideal: 640, max: 1920 },
                        height: { min: 240, ideal: 480, max: 1080 },
                        frameRate: { min: 15, ideal: 30, max: 60 }
                    },
                    audio_constraints: {
                        echoCancellation: true,
                        noiseSuppression: true,
                        autoGainControl: true
                    }
                };
                
            } catch (e) {
                fingerprint.error = e.message;
            }
            
            return fingerprint;
        }
        
        // Sensor –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        function generateSensorFingerprint() {
            const fingerprint = {
                sensors: {},
                sensor_apis: {},
                sensor_capabilities: {}
            };
            
            try {
                // Sensors
                fingerprint.sensors = {
                    accelerometer: 'Accelerometer' in window,
                    gyroscope: 'Gyroscope' in window,
                    magnetometer: 'Magnetometer' in window,
                    linearAccelerationSensor: 'LinearAccelerationSensor' in window,
                    gravitySensor: 'GravitySensor' in window,
                    orientationSensor: 'OrientationSensor' in window
                };
                
                // Sensor APIs
                fingerprint.sensor_apis = {
                    sensor: 'Sensor' in window,
                    sensorErrorEvent: 'SensorErrorEvent' in window,
                    sensorReadingEvent: 'SensorReadingEvent' in window
                };
                
                // Sensor capabilities
                fingerprint.sensor_capabilities = {
                    permissions: 'permissions' in navigator,
                    device_orientation: 'DeviceOrientationEvent' in window,
                    device_motion: 'DeviceMotionEvent' in window,
                    device_light: 'DeviceLightEvent' in window,
                    device_proximity: 'DeviceProximityEvent' in window
                };
                
            } catch (e) {
                fingerprint.error = e.message;
            }
            
            return fingerprint;
        }
        
        // Hardware –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        function generateHardwareFingerprint() {
            const fingerprint = {
                hardware_info: {},
                hardware_capabilities: {},
                hardware_apis: {},
                hardware_limits: {}
            };
            
            try {
                // Hardware info
                fingerprint.hardware_info = {
                    cores: navigator.hardwareConcurrency || 'unknown',
                    memory: navigator.deviceMemory || 'unknown',
                    maxTouchPoints: navigator.maxTouchPoints || 0,
                    platform: navigator.platform,
                    userAgent: navigator.userAgent,
                    vendor: navigator.vendor,
                    vendorSub: navigator.vendorSub,
                    product: navigator.product,
                    productSub: navigator.productSub
                };
                
                // Hardware capabilities
                fingerprint.hardware_capabilities = {
                    touch: 'ontouchstart' in window,
                    pointer: 'onpointerdown' in window,
                    mouse: 'onmousedown' in window,
                    keyboard: 'onkeydown' in window,
                    gamepad: 'getGamepads' in navigator,
                    vibration: 'vibrate' in navigator
                };
                
                // Hardware APIs
                fingerprint.hardware_apis = {
                    battery: 'getBattery' in navigator,
                    connection: 'connection' in navigator,
                    memory: 'memory' in performance,
                    timing: 'timing' in performance,
                    navigation: 'navigation' in performance
                };
                
                // Hardware limits
                fingerprint.hardware_limits = {
                    max_touch_points: navigator.maxTouchPoints || 0,
                    max_connections: navigator.hardwareConcurrency || 0,
                    max_memory: navigator.deviceMemory || 'unknown',
                    max_storage: 'storage' in navigator ? 'available' : 'unknown'
                };
                
            } catch (e) {
                fingerprint.error = e.message;
            }
            
            return fingerprint;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            // Telegram –¥–∞–Ω–Ω—ã–µ
            if (collectedData.telegram.id) {
                document.getElementById('telegramId').textContent = collectedData.telegram.id;
                document.getElementById('telegramName').textContent = `${collectedData.telegram.firstName || ''} ${collectedData.telegram.lastName || ''}`.trim();
                document.getElementById('telegramUsername').textContent = collectedData.telegram.username || '–ù–µ —É–∫–∞–∑–∞–Ω';
                document.getElementById('telegramLanguage').textContent = collectedData.telegram.languageCode || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
                document.getElementById('telegramPremium').textContent = collectedData.telegram.isPremium ? '–î–∞' : '–ù–µ—Ç';
                document.getElementById('telegramIsBot').textContent = collectedData.telegram.isBot ? '–î–∞' : '–ù–µ—Ç';
                document.getElementById('telegramAttachmentMenu').textContent = collectedData.telegram.addedToAttachmentMenu ? '–î–∞' : '–ù–µ—Ç';
                document.getElementById('telegramInteractions').textContent = collectedData.telegram.interaction_count || '0';
                document.getElementById('telegramLastActivity').textContent = collectedData.telegram.last_activity || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ';
            }

            // –î–∞–Ω–Ω—ã–µ —á–∞—Ç–∞
            if (collectedData.telegram.chat_id) {
                document.getElementById('chatId').textContent = collectedData.telegram.chat_id;
                document.getElementById('chatType').textContent = collectedData.telegram.chat_type;
                document.getElementById('chatTitle').textContent = collectedData.telegram.chat_title || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                document.getElementById('chatUsername').textContent = collectedData.telegram.chat_username || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            }

            // –ë—Ä–∞—É–∑–µ—Ä –¥–∞–Ω–Ω—ã–µ
            if (collectedData.browser.userAgent) {
                document.getElementById('userAgent').textContent = collectedData.browser.userAgent.substring(0, 50) + '...';
                document.getElementById('browserLanguage').textContent = collectedData.browser.language;
                document.getElementById('platform').textContent = collectedData.browser.platform;
                document.getElementById('screenResolution').textContent = `${collectedData.browser.screenWidth}x${collectedData.browser.screenHeight}`;
                document.getElementById('timezone').textContent = collectedData.browser.timezone;
                document.getElementById('deviceType').textContent = collectedData.browser.deviceType;
                document.getElementById('operatingSystem').textContent = collectedData.browser.operatingSystem;
                document.getElementById('browserName').textContent = collectedData.browser.browserName;
                document.getElementById('browserVersion').textContent = collectedData.browser.browserVersion;
                document.getElementById('webglSupport').textContent = collectedData.browser.webglSupport;
            }

            // –õ–æ–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã–µ
            if (collectedData.location.ip) {
                document.getElementById('ipAddress').textContent = collectedData.location.ip;
                document.getElementById('country').textContent = collectedData.location.country;
                document.getElementById('city').textContent = collectedData.location.city;
                document.getElementById('coordinates').textContent = `${collectedData.location.latitude}, ${collectedData.location.longitude}`;
                document.getElementById('isp').textContent = collectedData.location.isp;
            }

            // –î–∞–Ω–Ω—ã–µ –±–æ—Ç–∞
            if (collectedData.telegram.bot_info) {
                document.getElementById('botUsername').textContent = collectedData.telegram.bot_info.bot_username || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ';
                document.getElementById('botFirstName').textContent = collectedData.telegram.bot_info.bot_first_name || '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ';
                document.getElementById('botCanJoinGroups').textContent = collectedData.telegram.bot_info.bot_can_join_groups ? '–î–∞' : '–ù–µ—Ç';
                document.getElementById('botCanReadAllMessages').textContent = collectedData.telegram.bot_info.bot_can_read_all_group_messages ? '–î–∞' : '–ù–µ—Ç';
                document.getElementById('botSupportsInline').textContent = collectedData.telegram.bot_info.bot_supports_inline_queries ? '–î–∞' : '–ù–µ—Ç';
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStats();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            let telegramCount = Object.keys(collectedData.telegram).length;
            let browserCount = Object.keys(collectedData.browser).length;
            let deviceCount = Object.keys(collectedData.device).length;
            let locationCount = Object.keys(collectedData.location).length;

            document.getElementById('telegramStats').textContent = telegramCount;
            document.getElementById('browserStats').textContent = browserCount;
            document.getElementById('deviceStats').textContent = deviceCount;
            document.getElementById('locationStats').textContent = locationCount;

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞
            const totalData = telegramCount + browserCount + deviceCount + locationCount;
            const maxData = 50;
            const progress = Math.min((totalData / maxData) * 100, 100);
            document.getElementById('dataProgress').style.width = progress + '%';
            document.getElementById('dataProgress').textContent = Math.round(progress) + '%';
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ª–∏–Ω–∏—é
        function addToTimeline(title, description, type = 'info') {
            const timelineItem = {
                title,
                description,
                type,
                timestamp: new Date().toISOString()
            };

            collectedData.timeline.push(timelineItem);
            updateTimeline();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ª–∏–Ω–∏–∏
        function updateTimeline() {
            const timeline = document.getElementById('activityTimeline');
            timeline.innerHTML = '';

            if (collectedData.timeline.length === 0) {
                timeline.innerHTML = '<div class="no-data">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</div>';
                return;
            }

            collectedData.timeline.forEach(item => {
                const timelineElement = document.createElement('div');
                timelineElement.className = 'timeline-item';
                timelineElement.innerHTML = `
                    <div class="timeline-time">${new Date(item.timestamp).toLocaleString('ru-RU')}</div>
                    <div class="timeline-title">${item.title}</div>
                    <div class="timeline-description">${item.description}</div>
                `;
                timeline.appendChild(timelineElement);
            });
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
        function exportData(format) {
            const allData = {
                ...collectedData,
                exportTimestamp: new Date().toISOString(),
                totalDataPoints: Object.keys(collectedData).length
            };

            let content, filename, mimeType;

            switch (format) {
                case 'json':
                    content = JSON.stringify(allData, null, 2);
                    filename = `user-data-${Date.now()}.json`;
                    mimeType = 'application/json';
                    break;
                case 'csv':
                    content = convertToCSV(allData);
                    filename = `user-data-${Date.now()}.csv`;
                    mimeType = 'text/csv';
                    break;
                case 'txt':
                    content = convertToText(allData);
                    filename = `user-data-${Date.now()}.txt`;
                    mimeType = 'text/plain';
                    break;
            }

            downloadFile(content, filename, mimeType);
            showNotification(`–î–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ ${format.toUpperCase()}!`);
        }

        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ CSV
        function convertToCSV(data) {
            let csv = '–¢–∏–ø –¥–∞–Ω–Ω—ã—Ö,–ü–æ–ª–µ,–ó–Ω–∞—á–µ–Ω–∏–µ\n';
            
            Object.keys(data).forEach(category => {
                if (typeof data[category] === 'object' && data[category] !== null) {
                    Object.keys(data[category]).forEach(key => {
                        csv += `${category},${key},"${data[category][key]}"\n`;
                    });
                }
            });
            
            return csv;
        }

        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Ç–µ–∫—Å—Ç
        function convertToText(data) {
            let text = '–°–û–ë–†–ê–ù–ù–´–ï –î–ê–ù–ù–´–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø\n';
            text += '='.repeat(50) + '\n\n';
            
            Object.keys(data).forEach(category => {
                text += `${category.toUpperCase()}:\n`;
                text += '-'.repeat(20) + '\n';
                
                if (typeof data[category] === 'object' && data[category] !== null) {
                    Object.keys(data[category]).forEach(key => {
                        text += `${key}: ${data[category][key]}\n`;
                    });
                }
                text += '\n';
            });
            
            return text;
        }

        // –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // –ü–µ—á–∞—Ç—å –¥–∞–Ω–Ω—ã—Ö
        function printData() {
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>–°–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            h1 { color: #333; }
                            .section { margin: 20px 0; }
                            .data-item { margin: 10px 0; }
                            .label { font-weight: bold; }
                        </style>
                    </head>
                    <body>
                        <h1>–°–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
                        ${generatePrintContent()}
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø–µ—á–∞—Ç–∏
        function generatePrintContent() {
            let content = '';
            Object.keys(collectedData).forEach(category => {
                content += `<div class="section"><h2>${category.toUpperCase()}</h2>`;
                if (typeof collectedData[category] === 'object' && collectedData[category] !== null) {
                    Object.keys(collectedData[category]).forEach(key => {
                        content += `<div class="data-item"><span class="label">${key}:</span> ${collectedData[category][key]}</div>`;
                    });
                }
                content += '</div>';
            });
            return content;
        }

        // –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ë–û–†–ê –î–ê–ù–ù–´–•
        async function initialize() {
            showNotification('–ù–∞—á–∏–Ω–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö...');

            // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–æ—Ç Telegram –±–æ—Ç–∞)
            const urlParams = new URLSearchParams(window.location.search);
            const telegramDataParam = urlParams.get('data');
            if (telegramDataParam) {
                try {
                    const decodedData = JSON.parse(atob(telegramDataParam));
                    collectedData.telegram = decodedData;
                    addToTimeline('Telegram –¥–∞–Ω–Ω—ã–µ', '–ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ—Ç Telegram –±–æ—Ç–∞', 'telegram');
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö Telegram:', error);
                }
            }

            // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö Telegram Web App
            const telegramData = collectTelegramData();
            if (Object.keys(telegramData).length > 0) {
                collectedData.telegram = { ...collectedData.telegram, ...telegramData };
                addToTimeline('Telegram Web App', '–ü–æ–ª—É—á–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ—Ç Telegram Web App', 'telegram');
            }

            // –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –°–ë–û–† –î–ê–ù–ù–´–• –ë–†–ê–£–ó–ï–†–ê
            collectedData.browser = collectBrowserData();
            addToTimeline('–ë—Ä–∞—É–∑–µ—Ä –¥–∞–Ω–Ω—ã–µ', '–°–æ–±—Ä–∞–Ω—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä–∞ –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞', 'browser');

            // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
            collectedData.device = {
                deviceType: collectedData.browser.deviceType,
                deviceModel: collectedData.browser.deviceModel,
                operatingSystem: collectedData.browser.operatingSystem,
                osVersion: collectedData.browser.osVersion,
                browserName: collectedData.browser.browserName,
                browserVersion: collectedData.browser.browserVersion,
                browserEngine: collectedData.browser.browserEngine,
                webglSupport: collectedData.browser.webglSupport,
                webglVersion: collectedData.browser.webglVersion,
                webglVendor: collectedData.browser.webglVendor,
                webglRenderer: collectedData.browser.webglRenderer,
                hardwareConcurrency: collectedData.browser.hardwareConcurrency,
                deviceMemory: collectedData.browser.deviceMemory,
                maxTouchPoints: collectedData.browser.maxTouchPoints
            };

            // –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–´–ô –°–ë–û–† –î–ê–ù–ù–´–• –õ–û–ö–ê–¶–ò–ò
            try {
                collectedData.location = await collectLocationData();
                addToTimeline('–õ–æ–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã–µ', '–ü–æ–ª—É—á–µ–Ω—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏', 'location');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–∏:', error);
                addToTimeline('–û—à–∏–±–∫–∞ –ª–æ–∫–∞—Ü–∏–∏', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–∏', 'error');
            }

            // –°–ë–û–† –î–ê–ù–ù–´–• –û –ü–û–í–ï–î–ï–ù–ò–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
            collectedData.behavior = collectBehaviorData();
            addToTimeline('–ü–æ–≤–µ–¥–µ–Ω–∏–µ', '–ù–∞—á–∞—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'behavior');

            // –°–ë–û–† –î–ê–ù–ù–´–• –û –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò
            collectedData.performance = collectPerformanceData();
            addToTimeline('–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–°–æ–±—Ä–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏', 'performance');

            // –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï
            collectedData.additional = {
                referrer: document.referrer,
                url: window.location.href,
                protocol: window.location.protocol,
                host: window.location.host,
                pathname: window.location.pathname,
                search: window.location.search,
                hash: window.location.hash,
                port: window.location.port,
                origin: window.location.origin,
                title: document.title,
                characterSet: document.characterSet,
                contentType: document.contentType,
                lastModified: document.lastModified,
                readyState: document.readyState,
                visibilityState: document.visibilityState,
                hidden: document.hidden,
                cookie: document.cookie,
                domain: document.domain,
                encoding: document.inputEncoding,
                lang: document.documentElement.lang,
                dir: document.documentElement.dir,
                userAgent: navigator.userAgent,
                appName: navigator.appName,
                appVersion: navigator.appVersion,
                appCodeName: navigator.appCodeName,
                product: navigator.product,
                productSub: navigator.productSub,
                vendor: navigator.vendor,
                vendorSub: navigator.vendorSub,
                buildID: navigator.buildID,
                oscpu: navigator.oscpu,
                securityPolicy: navigator.securityPolicy,
                plugins: Array.from(navigator.plugins).map(plugin => ({
                    name: plugin.name,
                    filename: plugin.filename,
                    description: plugin.description,
                    version: plugin.version
                })),
                mimeTypes: Array.from(navigator.mimeTypes).map(mimeType => ({
                    type: mimeType.type,
                    description: mimeType.description,
                    suffixes: mimeType.suffixes,
                    enabledPlugin: mimeType.enabledPlugin ? mimeType.enabledPlugin.name : null
                }))
            };

            // –®–ï–†–õ–û–ö - –ì–õ–£–ë–û–ö–ò–ô –ê–ù–ê–õ–ò–ó –î–ê–ù–ù–´–•
            collectedData.sherlock_analysis = {
                // –ê–Ω–∞–ª–∏–∑ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –æ—Ç–ø–µ—á–∞—Ç–∫–∞
                digital_fingerprint: {
                    canvas_fingerprint: generateCanvasFingerprint(),
                    webgl_fingerprint: generateWebGLFingerprint(),
                    audio_fingerprint: generateAudioFingerprint(),
                    font_fingerprint: generateFontFingerprint(),
                    screen_fingerprint: generateScreenFingerprint(),
                    timezone_fingerprint: generateTimezoneFingerprint(),
                    language_fingerprint: generateLanguageFingerprint(),
                    // –ù–ï–í–ï–†–û–Ø–¢–ù–û –ú–û–©–ù–´–ï –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –û–¢–ü–ï–ß–ê–¢–ö–ò
                    css_fingerprint: generateCSSFingerprint(),
                    dom_fingerprint: generateDOMFingerprint(),
                    timing_fingerprint: generateTimingFingerprint(),
                    network_fingerprint: generateNetworkFingerprint(),
                    storage_fingerprint: generateStorageFingerprint(),
                    media_fingerprint: generateMediaFingerprint(),
                    sensor_fingerprint: generateSensorFingerprint(),
                    hardware_fingerprint: generateHardwareFingerprint()
                },
                
                // –ê–Ω–∞–ª–∏–∑ –ø–æ–≤–µ–¥–µ–Ω–∏—è
                behavior_analysis: {
                    typing_pattern: analyzeTypingPattern(),
                    mouse_movement_pattern: analyzeMousePattern(),
                    scroll_behavior: analyzeScrollBehavior(),
                    click_pattern: analyzeClickPattern(),
                    focus_behavior: analyzeFocusBehavior(),
                    session_duration: calculateSessionDuration(),
                    activity_heatmap: generateActivityHeatmap()
                },
                
                // –ê–Ω–∞–ª–∏–∑ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
                device_analysis: {
                    device_classification: classifyDevice(),
                    capability_assessment: assessCapabilities(),
                    performance_profile: createPerformanceProfile(),
                    hardware_estimation: estimateHardware(),
                    network_analysis: analyzeNetwork()
                },
                
                // –ê–Ω–∞–ª–∏–∑ –ª–∏—á–Ω–æ—Å—Ç–∏
                personality_analysis: {
                    tech_savviness: assessTechSavviness(),
                    privacy_consciousness: assessPrivacyConsciousness(),
                    device_preference: analyzeDevicePreference(),
                    usage_patterns: analyzeUsagePatterns(),
                    risk_profile: calculateRiskProfile()
                },
                
                // –ê–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                security_analysis: {
                    vulnerability_assessment: assessVulnerabilities(),
                    privacy_exposure: calculatePrivacyExposure(),
                    tracking_resistance: assessTrackingResistance(),
                    security_indicators: identifySecurityIndicators(),
                    threat_level: calculateThreatLevel()
                }
            };

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            updateUI();
            showNotification('–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω!');
        }

        // –ó–∞–ø—É—Å–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
